<app-navbar-student></app-navbar-student>
<div class="container">
  <div class="row">
    <div class="col-md-8 offset-md-3">
      <div class="chat-container">
        <div class="header">
          <h2>Chat</h2>
          <button class="load-previous" (click)="cargarMensajesAnteriores()">Leer mensajes anteriores</button>
        </div>
        <div class="messages">
          <div *ngFor="let mensaje of mensajes" class="message"
            [ngClass]="{'sent': mensaje.sent === true, 'received': mensaje.sent === false}">
            <div *ngIf="mensaje.contenido !== null" class="message-content">{{ mensaje.contenido }}</div>
            <div *ngIf="mensaje.archivo_url" class="message-content">
              <a [href]="mensaje.archivo_url" download>
                <i class="fa fa-download"></i> Descargar archivo
              </a>
            </div>

            <div *ngIf="mensaje.audio_url" class="message-content">
              <audio controls>
                <source [src]="mensaje.audio_url" type="audio/mpeg">
                Tu navegador no soporta la reproducci√≥n de audio.
              </audio>
            </div>
          </div>
        </div>

        <div class="input-container">
          <input type="text" [(ngModel)]="nuevoMensaje" placeholder="Escribe un mensaje..." class="message-input">
          <button (click)="iniciarGrabacion()" [disabled]="grabando" class="record-button">Grabar mensaje de
            voz</button>
          <button (click)="detenerGrabacion()" [disabled]="!grabando" class="stop-record-button">Detener</button>
          <input id="fileInput" type="file" (change)="onFileSelected($event)">
          <button (click)="enviarMensaje()" class="send-button">Enviar</button>
        </div>
      </div>
    </div>
  </div>
</div>